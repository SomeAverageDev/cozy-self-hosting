{"version":3,"sources":["app/application.js","app/initialize.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAjHA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AALA;AAAA","file":"public\\javascripts\\app.js","sourcesContent":["var refresh_fqdn = function() {\n    // Get fqdn from CozyDB\n    $.get(\"./debian/fqdn\", function(data) {\n        // And update view\n        $(\"#input-fqdn\").val(data);\n    });\n};\n\nvar save_fqdn = function() {\n    // Get new value in input text\n    var form_value = $(\"#input-fqdn\").val();\n    // Push configuration\n    $.post(\"./debian/fqdn\", {fqdn: form_value}, function(data) {\n        $(\"#div-status-ko\").hide();\n        $(\"#div-status-ok\").html(data.message).show();\n    });\n};\n\nvar host_halt = function() {\n\t// ask for halt host\n\t$(\"#button-halt\").confirmation('hide')\n    $.get(\"./debian/host/halt\", function(data) {\n        $(\"#div-status-ko\").hide();\n        $(\"#div-status-ok\").html(data.message).show();\n    });\n};\n\nvar host_reboot = function() {\n\t// ask for halt host\n\t$(\"#button-reboot\").confirmation('hide')\n    $.get(\"./debian/host/reboot\", function(data) {\n        $(\"#div-status-ko\").hide();\n        $(\"#div-status-ok\").html(data.message).show();\n    });\n};\n\nvar show_halt_reboot_buttons = function() {\n    // Get fqdn from CozyDB\n    $.get(\"./debian/host/isvps\", function(data) {\n        if (data.isVPS === false) {\n\t\t\t$(\"#button-halt-reboot-div\").show();\n        }\n    });\n};\n\nvar database_maintenance = function(option) {\n\tvar url = \"./debian/database/\"+option;\n\n\t$(\"#div-status-ko\").hide();\n\t$(\"#div-status-ok\").html('Database maintenance operation \"' + option + '\" is running...').show();\n\n    $.get(url, function(data) {\n        $(\"#div-status-ko\").hide();\n        $(\"#div-status-ok\").html(data.message).show();\n    });\n};\n\nvar Application = {\n  initialize: function () {\n\t  show_halt_reboot_buttons();\n      refresh_fqdn();\n      $(\"#button-refresh\").click(function() {\n          refresh_fqdn();\n      });\n      $(\"#button-reconfigure\").click(function() {\n          save_fqdn();\n      });\n      $(\"#button-db-compact\").click(function() {\n          database_maintenance(\"compact\");\n      });\n      $(\"#button-db-compact-views\").click(function() {\n          database_maintenance(\"views\");\n      });\n      $(\"#button-db-cleanup\").click(function() {\n          database_maintenance(\"cleanup\");\n      });\n\n\t  $(\"#button-halt\").confirmation({\n\t\t\"title\": \"Do you really want to halt the host ?\",\n\t\t\"btnOkClass\": \"btn-danger\",\n\t\t\"btnCancelClass\": \"btn-info\",\n\t\t\"btnOkLabel\": \"SHUTDOWN\",\n\t\t\"btnCancelLabel\": \"CANCEL\",\n\t\t\"placement\": \"bottom\",\n\t\t\"popout\": true,\n\t\t\"singleton\": true,\n\t\t\"onConfirm\": host_halt\n\t  });\n\t  $(\"#button-reboot\").confirmation({\n\t\t\"title\": \"Do you really want to reboot the host ?\",\n\t\t\"btnOkClass\": \"btn-warning\",\n\t\t\"btnCancelClass\": \"btn-info\",\n\t\t\"btnOkLabel\": \"REBOOT\",\n\t\t\"btnCancelLabel\": \"CANCEL\",\n\t\t\"placement\": \"bottom\",\n\t\t\"popout\": true,\n\t\t\"singleton\": true,\n\t\t\"onConfirm\": host_reboot\n\t  });\n\n      $(document).ajaxError(function(event, jqxhr, settings, thrownError) {\n        $(\"#div-status-ok\").hide();\n\t\tvar data = JSON.parse(jqxhr.responseText);\n\t\tif (data.message) {\n\t\t\t$(\"#div-status-ko\").html(thrownError + ':<br/>\\n' + data.message).show();\n\t\t} else {\n\t\t\t$(\"#div-status-ko\").html(thrownError + ':<br/>\\n' + jqxhr.responseText).show();\n\t\t}\n      });\n  }\n};\n\nmodule.exports = Application;\n","var application = require('application');\r\n\r\n$(function () {\r\n  application.initialize();\r\n});\r\n"]}